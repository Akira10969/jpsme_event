# Security settings for uploads directory
# Prevent execution of PHP files in uploads directory

# Disable PHP execution
<Files "*.php">
    Order Allow,Deny
    Deny from all
</Files>

<Files "*.php3">
    Order Allow,Deny
    Deny from all
</Files>

<Files "*.php4">
    Order Allow,Deny
    Deny from all
</Files>

<Files "*.php5">
    Order Allow,Deny
    Deny from all
</Files>

<Files "*.phtml">
    Order Allow,Deny
    Deny from all
</Files>

# Remove PHP handler
RemoveHandler .php .phtml .php3 .php4 .php5

# Only allow specific file types
<FilesMatch "^.*\.(pdf|jpg|jpeg|png)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# Deny everything else
<FilesMatch "^.*$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# Prevent directory browsing
Options -Indexes

# Security headers for file downloads
<IfModule mod_headers.c>
    Header set X-Content-Type-Options nosniff
    Header set Content-Disposition attachment
</IfModule>
